@using System.Configuration; 
@using System.Data.SqlClient;
@using System.Data;

@{
    SqlConnection conn = new SqlConnection("Data Source = (localdb)\\MSSQLLocalDB; Database=master");
    DataTable dt = new DataTable();
    //var connectionString = "Data Source = (localdb)\\MSSQLLocalDB; Database=master";
    //var providerName = "System.Data.SqlClient";
    var queryStr = "SELECT * FROM expenses";
    SqlDataAdapter sda = new SqlDataAdapter(queryStr, conn);
    sda.Fill(dt);
    string attach = "attachment;filename=report.xls";
    Response.ClearContent();
    Response.AddHeader("content-disposition", attach);
    Response.ContentType = "application/ms-excel";
    if (dt != null)
    {
        foreach (DataColumn dc in dt.Columns)
        {
            Response.Write(dc.ColumnName + "\t");
            //sep = ";";
        }
        Response.Write(System.Environment.NewLine);
        foreach (DataRow dr in dt.Rows)
        {
            for (int i = 0; i < dt.Columns.Count; i++)
            {
                Response.Write(dr[i].ToString() + "\t");
            }
            Response.Write("\n");
        }
        Response.End();
    }
}